<!DOCTYPE html>
<html lang="en" class="fuelux">
<head>
	<meta charset="utf-8">
	<title>dev.html</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link href="../bower_components/bootstrap/dist/css/bootstrap.css" rel="stylesheet" type="text/css">

	<!--<link href="../dist/css/fuelux.css" rel="stylesheet" type="text/css">-->

	<!--CLIENT-SIDE LESS COMPILATION FOR WATCHER-LESS DEV-->
	<link href="../less/fuelux.less" rel="stylesheet/less" type="text/css"/>
	<script src="//cdnjs.cloudflare.com/ajax/libs/less.js/1.7.0/less.min.js"></script>
	<script type="text/javascript">if(window.console && window.console.clear){ window.console.clear(); }</script>

	<script src="../bower_components/requirejs/require.js" type="text/javascript"></script>
	<script type="text/javascript">
		(function () {
			requirejs.config({
				config: {
					moment: {
						noGlobal: true
					}
				},
				paths: {
					jquery: '../bower_components/jquery/dist/jquery',
					underscore: '../bower_components/underscore/underscore',
					bootstrap: '../bower_components/bootstrap/dist/js/bootstrap',
					//moment: '../bower_components/moment/min/moment-with-langs',
					fuelux: '../js'
				},
				shim: {
					'bootstrap': {
						deps: ['jquery'],
						exports: 'bootstrap'
					}
				}
			});
		})();
		require(['jquery', 'underscore', '../data', 'fuelux/all'], function($, _, data){
			var rootNodesRendered = false;
			var nodeId = 0;

			window.treeDataSource = function(options, callback) {
				var nodes = [];

				if(options.children) {
					var folderSelect = $('#myTree').data('fu.tree').options.folderSelect || false;
					nodes = options.children;

//					if(folderSelect) {
//						// remove any items, only show folders
//						nodes = _.filter(nodes, function(node) {
//							return node.type === 'folder';
//						});
//					}
				}
				else if(!rootNodesRendered) {
					// render root nodes
					nodes = data.tree;
					rootNodesRendered = true;
				}

				_.each(nodes, function(node, index) {
					if(!node.dataAttributes) {
						node.dataAttributes = {};
					}
					if(!node.dataAttributes.id) {
						// ensure each node has an identifier
						node.dataAttributes.id = 'node' + (nodeId += 1);
					}
					if(!node.value) {
						// ensure each node has a value (sync with id if needed)
						node.value = node.dataAttributes.id;
					}

					// determine whether the node has children
					// note: this will be used to hide the caret if necessary
					node.dataAttributes.hasChildren = (node.children && node.children.length > 0) ? true : false;
				});

				var dataSource = {
					data: nodes
				};

				// simulate delay
				window.setTimeout(function() {
					callback(dataSource), 2000
				}, 500);
			};


			$('#myTree').tree({
				dataSource: window.treeDataSource,
				multiSelect: false,
				cacheItems: true,
				folderSelect: true
			});
		});
	</script>
</head>

<body style="padding: 20px;">
	<div class="container" style="padding: 20px; margin-top:20px;">
		<ul class="tree" role="tree" id="myTree">
			<li class="tree-branch hide" data-template="treebranch" role="treeitem" aria-expanded="false">
				<div class="tree-branch-header">
					<button class="tree-branch-name">
						<span class="glyphicon icon-caret glyphicon-play"></span>
						<span class="glyphicon icon-folder glyphicon-folder-close"></span>
						<span class="tree-label"></span>
					</button>
				</div>
				<ul class="tree-branch-children" role="group"></ul>
				<div class="tree-loader" role="alert">Loading...</div>
			</li>
			<li class="tree-item hide" data-template="treeitem" role="treeitem">
				<button class="tree-item-name">
					<span class="glyphicon icon-item fueluxicon-bullet"></span>
					<span class="tree-label"></span>
				</button>
			</li>
		</ul>
	</div>
</body>
</html>
