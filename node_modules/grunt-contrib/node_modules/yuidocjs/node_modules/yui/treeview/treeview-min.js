/*
YUI 3.6.0pr3 (build 1)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("treeview",function(a){var l=a.ClassNameManager.getClassName,j="treeview",v="tree",q="treeleaf",o="contentBox",y="boundingBox",k=true,s=a.Widget,f="value",i="content",b=a.Widget,x=a.Node,m="id",p="destroyed",u="body",e=40,t=37,n=39,r=38,g=a.Handlebars,c=a.ClassNameManager.getClassName,d=a.Widget.getClassName,w={loading:l(j,"loading"),tree:l(v),treeLabel:l(j,"treelabel"),labelcontent:l(j,"label-content"),treeview:l(j),treeviewcontent:l(j,"content"),collapsed:l(v,"collapsed"),leaf:l(q)},h=function(B,z){var A;if(B.get("initialized")&&!B.get("rendered")&&!B._handling&&B.get("DOMReady")){B._handling=k;B.render();A=B._state.get(z,f);}return A;};a.WidgetHTMLRenderer=function(){};a.WidgetHTMLRenderer.prototype={renderHTML:function(C){var D,A,z,B;if(!this.get(p)){z={};A=[];this.renderUI(A,z);z.content=A.join("");D=[];this._renderUI(D,z);B=D.join("");if(C){if(x&&C instanceof x){C.append(B);}else{C.push(B);}}this._renderedUI=true;}return B;},_renderHTML:function(){var B=this.DEF_PARENT_NODE,z=this._parentNode||(B&&x.one(B)),A=z||[],C;this.renderHTML(A);if(!z){C=A.join();x.one(u).insert(C,0);}},_renderUI:function(z,A){this._renderBox(z,A);},_renderBox:function(z,A){A.id=this.get(m);this._renderBoxClassNames(A);if(this.CONTENT_TEMPLATE){A.contentBox=g.render(this.CONTENT_TEMPLATE,A);}else{A.contentBox=A.content;}z.push(g.render(this.BOUNDING_TEMPLATE,A));this._mapInstance(A.id);},_renderBoxClassNames:function(D){var C=this._getClasses(),z,B,A=this.getClassName(i),E=[];E[E.length]=d();for(B=C.length-3;B>=0;B--){z=C[B];E[E.length]=z.CSS_PREFIX||c(z.NAME.toLowerCase());}if(this.CONTENT_TEMPLATE===null){E.push(A);}else{D.contentClasses=A;}D.boundingClasses=E.join(" ");},syncRenderedBoxes:function(){var A=a.Node.one("#"+this.get(m)),z=(this.CONTENT_TEMPLATE===null)?A:A.one("."+this.getClassName(i));this._set("boundingBox",A);this._set("contentBox",z);},renderer:function(){if(!this._renderedUI){this._renderHTML();}this.syncRenderedBoxes();this._bindUI();this.bindUI();this._syncUI();this.syncUI();},BOUNDING_TEMPLATE:'<div id="{{id}}" class="{{boundingClasses}}">{{{contentBox}}}</div>',CONTENT_TEMPLATE:'<div class="{{contentClasses}}">{{{content}}}</div>',_setBox:function(A,z){z=x.one(z);if(z&&!z.get(m)){z.set(m,A||a.guid());}return z;}};a.TreeView=a.Base.create("treeview",s,[a.WidgetParent,a.WidgetChild,a.WidgetHTMLRenderer],{BOUNDING_TEMPLATE:'<ul id="{{id}}" class="{{boundingClasses}}">{{{contentBox}}}</ul>',TREEVIEWLABEL_TEMPLATE:"<li class='{{{treelabelClassName}}}' role='treeitem' tabindex='0'><span class={{{labelcontentClassName}}}>{{{label}}}</span></li>",initializer:function(z){this.publish("toggleTreeState",{defaultFn:this.toggleTreeState});a.after(this._setChildrenContainer,this,"render");},renderUI:function(E){var B=this.get("label"),C,A=this.get("depth")>-1,z=this.getClassName("treelabel"),D=w.labelcontent;this.BOUNDING_TEMPLATE=A?'<li id="{{{id}}}" role="presentation" class="{{{boundingClasses}}}">{{{contentBox}}}</li>':'<ul id="{{{id}}}" role="tree" class="{{{boundingClasses}}}">{{{contentBox}}}</ul>';this.CONTENT_TEMPLATE=A?'<ul id="{{id}}" role="group" class="{{{contentClasses}}}">{{{content}}}</ul>':null;C=a.Handlebars.render(this.TREEVIEWLABEL_TEMPLATE,{label:B,treelabelClassName:z,labelcontentClassName:D});E.push(C);},bindUI:function(){if(this.isRoot()){this.get("boundingBox").delegate("click",this._onViewEvents,"."+w.labelcontent,this);this.get("boundingBox").on("keydown",this._onKeyDown,this);this._keyEvents=[];this._keyEvents[r]=this._onUpKey;this._keyEvents[e]=this._onDownKey;this._keyEvents[t]=this._onLeftArrowKey;this._keyEvents[n]=this._onRightArrowKey;}},_onViewEvents:function(z){var A=z.target;this.toggleTreeState(A);},_onKeyDown:function(C){var B=C.keyCode,A=C.target,z=this._keyEvents[B];if(z){z.call(this,C,A);}},_onUpKey:function(B,A){var z=A.previous("li");B.preventDefault();if(z){z.focus();}},_onDownKey:function(B,A){var z=A.next("li");B.preventDefault();if(z){z.focus();}},_onRightArrowKey:function(A,z){if(z.hasClass(w.treeLabel)){this.expand(z);}},_onLeftArrowKey:function(A,z){if(z.hasClass(w.treeLabel)){this.collapse(z);}},_renderChildren:function(A){var z;if(!this.get("lazyLoad")){z=this._getChildrenHTML(this);A.push(z);}},_getChildrenHTML:function(z){var A="";z.each(function(B){A+=B.renderHTML();B.set("DOMReady",true);});return A;},_lazyRenderChildren:function(A,B){var z=A._getChildrenHTML(A);B.append(z);A.set("populated",true);},collapse:function(B){var A=B?B.ancestor("."+w.treeviewcontent):this.get("contentBox"),z=a.Widget.getByNode(A);if(!z.get("collapsed")){z.set("collapsed",true);A.addClass(w.collapsed);A.setAttrs({"aria-collapsed":true});}},expand:function(C){var B=C?C.ancestor("."+w.treeviewcontent):this.get("contentBox"),A=a.Widget.getByNode(B),z=A.get("populated");if(this.get("lazyLoad")&&!z){A._lazyRenderChildren(A,B);A.set("populated",true);}if(A.get("collapsed")){A.set("collapsed",false);B.removeClass(w.collapsed);B.setAttrs({"aria-collapsed":false});}},toggleTreeState:function(C){var B=C?C.ancestor("."+w.treeviewcontent):this.get("contentBox"),A=a.Widget.getByNode(B),z=A.get("populated");if(this.get("lazyLoad")&&!z){A._lazyRenderChildren(A,B);A.set("populated",true);}A.set("collapsed",!A.get("collapsed"));B.toggleClass(w.collapsed);},_setChildrenContainer:function(){var z=this._childrenContainer||this.get("contentBox");this._childrenContainer=z;},_renderBoxClassNames:function(D){var C=this._getClasses(),z,B,A=this.getClassName(i),E=[];E[E.length]=b.getClassName();for(B=C.length-3;B>=0;B--){z=C[B];E[E.length]=a.ClassNameManager.getClassName(z.NAME.toLowerCase())||this.getClassName(z.NAME.toLowerCase());}if(this.CONTENT_TEMPLATE===null){E.push(A);E.push(w.collapsed);}else{D.contentClasses=A+" "+w.collapsed;}D.boundingClasses=E.join(" ");},_uiAddChild:function(F,z){var B=F.get("parent"),D,C,E,A;if(B.get("populated")){F.render(z);D=F.get("boundingBox");E=F.next(false);if(E&&E.get("DOMReady")){C=E.get(y);C.insert(D,"before");}else{A=F.previous(false);if(A&&A.get("DOMReady")){C=A.get(y);
C.insert(D,"after");}else{if(!z.contains(D)){z.appendChild(D);}}}}}},{ATTRS:{label:{value:""},DOMReady:{},lazyLoad:{writeOnce:"initOnly",value:true},populated:{readOnly:true},collapsed:{value:true},defaultChildType:{value:"TreeLeaf"},boundingBox:{getter:function(z){return z?z:h(this,y);}},contentBox:{getter:function(z){return z?z:h(this,o);}}}});a.TreeLeaf=a.Base.create("treeleaf",s,[a.WidgetChild,a.WidgetHTMLRenderer],{BOUNDING_TEMPLATE:'<li id="{{id}}" role="treeitem" class="{{boundingClasses}}" tabindex="-1">{{{contentBox}}}</li>',CONTENT_TEMPLATE:null,renderUI:function(z){z.push(this.get("label"));}},{ATTRS:{DOMReady:{value:false},label:{},boundingBox:{getter:function(z){return z?z:h(this,y);}},contentBox:{getter:function(z){return z?z:h(this,o);}}}});},"3.6.0pr3",{requires:["base","widget","widget-parent","widget-child","node-focusmanager","handlebars"]});