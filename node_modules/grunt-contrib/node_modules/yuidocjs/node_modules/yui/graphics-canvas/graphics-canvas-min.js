/*
YUI 3.6.0pr3 (build 1)
Copyright 2012 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/
YUI.add("graphics-canvas",function(c){var r="canvasShape",f=c.config.doc,t=c.Lang,l=c.AttributeLite,m,o,u,p,j,g,i=c.Color,q=parseInt,h=parseFloat,n=t.isNumber,k=RegExp,s=i.toRGB,a=i.toHex,e=c.ClassNameManager.getClassName;function b(){}b.prototype={_currentX:0,_currentY:0,_toRGBA:function(w,v){v=(v!==undefined)?v:1;if(!i.re_RGB.test(w)){w=a(w);}if(i.re_hex.exec(w)){w="rgba("+[q(k.$1,16),q(k.$2,16),q(k.$3,16)].join(",")+","+v+")";}return w;},_toRGB:function(v){return s(v);},setSize:function(v,x){if(this.get("autoSize")){if(v>this.node.getAttribute("width")){this.node.style.width=v+"px";this.node.setAttribute("width",v);}if(x>this.node.getAttribute("height")){this.node.style.height=x+"px";this.node.setAttribute("height",x);}}},_updateCoords:function(v,w){this._xcoords.push(v);this._ycoords.push(w);this._currentX=v;this._currentY=w;},_clearAndUpdateCoords:function(){var v=this._xcoords.pop()||0,w=this._ycoords.pop()||0;this._updateCoords(v,w);},_updateNodePosition:function(){var w=this.get("node"),v=this.get("x"),z=this.get("y");w.style.position="absolute";w.style.left=(v+this._left)+"px";w.style.top=(z+this._top)+"px";},_updateDrawingQueue:function(v){this._methods.push(v);},lineTo:function(E,C,v){var B=arguments,w=0,A,F,D,z=this._stroke&&this._strokeWeight?this._strokeWeight:0;if(!this._lineToMethods){this._lineToMethods=[];}if(typeof E==="string"||typeof E==="number"){B=[[E,C]];}A=B.length;for(;w<A;++w){if(B[w]){F=B[w][0];D=B[w][1];this._updateDrawingQueue(["lineTo",F,D]);this._lineToMethods[this._lineToMethods.length]=this._methods[this._methods.length-1];this._trackSize(F-z,D-z);this._trackSize(F+z,D+z);this._updateCoords(F,D);}}this._drawingComplete=false;return this;},moveTo:function(w,z){var v=this._stroke&&this._strokeWeight?this._strokeWeight:0;this._updateDrawingQueue(["moveTo",w,z]);this._trackSize(w-v,z-v);this._trackSize(w+v,z+v);this._updateCoords(w,z);this._drawingComplete=false;return this;},curveTo:function(B,z,J,I,F,E){var G,C,K,H,A,v,D;this._updateDrawingQueue(["bezierCurveTo",B,z,J,I,F,E]);this._drawingComplete=false;H=Math.max(F,Math.max(B,J));v=Math.max(E,Math.max(z,I));A=Math.min(F,Math.min(B,J));D=Math.min(E,Math.min(z,I));G=Math.abs(H-A);C=Math.abs(v-D);K=[[this._currentX,this._currentY],[B,z],[J,I],[F,E]];this._setCurveBoundingBox(K,G,C);this._updateCoords(F,E);return this;},quadraticCurveTo:function(B,A,G,F){var H,C,J,I,z,v,E,D=this._stroke&&this._strokeWeight?this._strokeWeight:0;this._updateDrawingQueue(["quadraticCurveTo",B,A,G,F]);this._drawingComplete=false;I=Math.max(G,B);v=Math.max(F,A);z=Math.min(G,B);E=Math.min(F,A);H=Math.abs(I-z);C=Math.abs(v-E);J=[[this._currentX,this._currentY],[B,A],[G,F]];this._setCurveBoundingBox(J,H,C);this._updateCoords(G,F);return this;},drawCircle:function(z,D,w){var B=0,A=2*Math.PI,v=this._stroke&&this._strokeWeight?this._strokeWeight:0,C=w*2;C+=v;this._drawingComplete=false;this._trackSize(z+C,D+C);this._trackSize(z-v,D-v);this._updateCoords(z,D);this._updateDrawingQueue(["arc",z+w,D+w,w,B,A,false]);return this;},drawDiamond:function(w,C,B,v){var A=B*0.5,z=v*0.5;this.moveTo(w+A,C);this.lineTo(w+B,C+z);this.lineTo(w+A,C+v);this.lineTo(w,C+z);this.lineTo(w+A,C);return this;},drawEllipse:function(J,H,K,P){var M=8,E=-(45/180)*Math.PI,R=0,D,B=K/2,C=P/2,N=0,G=J+B,F=H+C,L,I,Q,O,A,z,v=this._stroke&&this._strokeWeight?this._strokeWeight:0;L=G+Math.cos(0)*B;I=F+Math.sin(0)*C;this.moveTo(L,I);for(;N<M;N++){R+=E;D=R-(E/2);Q=G+Math.cos(R)*B;O=F+Math.sin(R)*C;A=G+Math.cos(D)*(B/Math.cos(E/2));z=F+Math.sin(D)*(C/Math.cos(E/2));this._updateDrawingQueue(["quadraticCurveTo",A,z,Q,O]);}this._trackSize(J+K+v,H+P+v);this._trackSize(J-v,H-v);this._updateCoords(J,H);return this;},drawRect:function(z,C,A,B){var v=this._stroke&&this._strokeWeight?this._strokeWeight:0;this._drawingComplete=false;this.moveTo(z,C);this.lineTo(z+A,C);this.lineTo(z+A,C+B);this.lineTo(z,C+B);this.lineTo(z,C);return this;},drawRoundRect:function(z,E,A,C,B,D){var v=this._stroke&&this._strokeWeight?this._strokeWeight:0;this._drawingComplete=false;this.moveTo(z,E+D);this.lineTo(z,E+C-D);this.quadraticCurveTo(z,E+C,z+B,E+C);this.lineTo(z+A-B,E+C);this.quadraticCurveTo(z+A,E+C,z+A,E+C-D);this.lineTo(z+A,E+D);this.quadraticCurveTo(z+A,E,z+A-B,E);this.lineTo(z+B,E);this.quadraticCurveTo(z,E,z,E+D);return this;},drawWedge:function(H,F,L,E,A,B){var v=this._stroke&&this._strokeWeight?this._strokeWeight:0,K,J,D,P,C,I,G,O,N,z,w,M=0;B=B||A;this._drawingComplete=false;this._updateDrawingQueue(["moveTo",H,F]);B=B||A;if(Math.abs(E)>360){E=360;}K=Math.ceil(Math.abs(E)/45);J=E/K;D=-(J/180)*Math.PI;P=(L/180)*Math.PI;if(K>0){I=H+Math.cos(L/180*Math.PI)*A;G=F+Math.sin(L/180*Math.PI)*B;this.lineTo(I,G);for(;M<K;++M){P+=D;C=P-(D/2);O=H+Math.cos(P)*A;N=F+Math.sin(P)*B;z=H+Math.cos(C)*(A/Math.cos(D/2));w=F+Math.sin(C)*(B/Math.cos(D/2));this._updateDrawingQueue(["quadraticCurveTo",z,w,O,N]);}this._updateDrawingQueue(["lineTo",H,F]);}this._trackSize(0-v,0-v);this._trackSize((A*2)+v,(A*2)+v);return this;},end:function(){this._closePath();return this;},closePath:function(){this._updateDrawingQueue(["closePath"]);this._updateDrawingQueue(["beginPath"]);},_getLinearGradient:function(){var K=c.Lang.isNumber,P=this.get("fill"),G=P.stops,D,O,N,Q=0,R=G.length,v,I=0,H=0,J=this.get("width"),S=this.get("height"),M=P.rotation||0,U,T,C,A,B=I+J/2,z=H+S/2,F,E=Math.PI/180,L=parseFloat(parseFloat(Math.tan(M*E)).toFixed(8));if(Math.abs(L)*J/2>=S/2){if(M<180){C=H;A=H+S;}else{C=H+S;A=H;}U=B-((z-C)/L);T=B-((z-A)/L);}else{if(M>90&&M<270){U=I+J;T=I;}else{U=I;T=I+J;}C=((L*(B-U))-z)*-1;A=((L*(B-T))-z)*-1;}v=this._context.createLinearGradient(U,C,T,A);for(;Q<R;++Q){N=G[Q];D=N.opacity;O=N.color;F=N.offset;if(K(D)){D=Math.max(0,Math.min(1,D));O=this._toRGBA(O,D);}else{O=s(O);}F=N.offset||Q/(R-1);v.addColorStop(F,O);}return v;},_getRadialGradient:function(){var N=c.Lang.isNumber,T=this.get("fill"),O=T.r,F=T.fx,D=T.fy,H=T.stops,E,Q,P,U=0,W=H.length,z,K=0,J=0,L=this.get("width"),X=this.get("height"),Y,V,C,B,S,R,v,M,Z,aa,G,I,A;R=K+L/2;
v=J+X/2;Y=L*F;C=X*D;V=K+L/2;B=J+X/2;S=L*O;aa=Math.sqrt(Math.pow(Math.abs(R-Y),2)+Math.pow(Math.abs(v-C),2));if(aa>=S){I=aa/S;if(I===1){I=1.01;}M=(Y-R)/I;Z=(C-v)/I;M=M>0?Math.floor(M):Math.ceil(M);Z=Z>0?Math.floor(Z):Math.ceil(Z);Y=R+M;C=v+Z;}if(O>=0.5){z=this._context.createRadialGradient(Y,C,O,V,B,O*L);A=1;}else{z=this._context.createRadialGradient(Y,C,O,V,B,L/2);A=O*2;}for(;U<W;++U){P=H[U];E=P.opacity;Q=P.color;G=P.offset;if(N(E)){E=Math.max(0,Math.min(1,E));Q=this._toRGBA(Q,E);}else{Q=s(Q);}G=P.offset||U/(W-1);G*=A;if(G<=1){z.addColorStop(G,Q);}}return z;},_initProps:function(){this._methods=[];this._lineToMethods=[];this._xcoords=[0];this._ycoords=[0];this._width=0;this._height=0;this._left=0;this._top=0;this._right=0;this._bottom=0;this._currentX=0;this._currentY=0;},_drawingComplete:false,_createGraphic:function(v){var w=c.config.doc.createElement("canvas");return w;},getBezierData:function(z,y){var A=z.length,x=[],w,v;for(w=0;w<A;++w){x[w]=[z[w][0],z[w][1]];}for(v=1;v<A;++v){for(w=0;w<A-v;++w){x[w][0]=(1-y)*x[w][0]+y*x[parseInt(w+1,10)][0];x[w][1]=(1-y)*x[w][1]+y*x[parseInt(w+1,10)][1];}}return[x[0][0],x[0][1]];},_setCurveBoundingBox:function(H,D,z){var y=0,x=this._currentX,E=x,C=this._currentY,v=C,B=Math.round(Math.sqrt((D*D)+(z*z))),F=1/B,A=this._stroke&&this._strokeWeight?this._strokeWeight:0,G;for(;y<B;++y){G=this.getBezierData(H,F*y);x=isNaN(x)?G[0]:Math.min(G[0],x);E=isNaN(E)?G[0]:Math.max(G[0],E);C=isNaN(C)?G[1]:Math.min(G[1],C);v=isNaN(v)?G[1]:Math.max(G[1],v);}x=Math.round(x*10)/10;E=Math.round(E*10)/10;C=Math.round(C*10)/10;v=Math.round(v*10)/10;this._trackSize(E+A,v+A);this._trackSize(x-A,C-A);},_trackSize:function(v,x){if(v>this._right){this._right=v;}if(v<this._left){this._left=v;}if(x<this._top){this._top=x;}if(x>this._bottom){this._bottom=x;}this._width=this._right-this._left;this._height=this._bottom-this._top;}};c.CanvasDrawing=b;m=function(v){this._transforms=[];this.matrix=new c.Matrix();m.superclass.constructor.apply(this,arguments);};m.NAME="canvasShape";c.extend(m,c.GraphicBase,c.mix({init:function(){this.initializer.apply(this,arguments);},initializer:function(v){var w=this,x=v.graphic;w._initProps();w.createNode();w._xcoords=[0];w._ycoords=[0];if(x){this._setGraphic(x);}w._updateHandler();},_setGraphic:function(v){var w;if(v instanceof c.CanvasGraphic){this._graphic=v;}else{v=c.one(v);w=new c.CanvasGraphic({render:v});w._appendShape(this);this._graphic=w;}},addClass:function(v){var w=c.one(this.get("node"));w.addClass(v);},removeClass:function(v){var w=c.one(this.get("node"));w.removeClass(v);},getXY:function(){var A=this.get("graphic"),w=A.getXY(),v=this.get("x"),z=this.get("y");return[w[0]+v,w[1]+z];},setXY:function(z){var B=this.get("graphic"),w=B.getXY(),v=z[0]-w[0],A=z[1]-w[1];this._set("x",v);this._set("y",A);this._updateNodePosition(v,A);},contains:function(v){return v===c.one(this.node);},test:function(v){return c.one(this.get("node")).test(v);},compareTo:function(v){var w=this.node;return w===v;},_getDefaultFill:function(){return{type:"solid",cx:0.5,cy:0.5,fx:0.5,fy:0.5,r:0.5};},_getDefaultStroke:function(){return{weight:1,dashstyle:"none",color:"#000",opacity:1};},_left:0,_right:0,_top:0,_bottom:0,createNode:function(){var v=c.config.doc.createElement("canvas"),w=this.get("id");this._context=v.getContext("2d");v.setAttribute("overflow","visible");v.style.overflow="visible";if(!this.get("visible")){v.style.visibility="hidden";}v.setAttribute("id",w);w="#"+w;this.node=v;this.addClass(e(r)+" "+e(this.name));},on:function(w,v){if(c.Node.DOM_EVENTS[w]){return c.one("#"+this.get("id")).on(w,v);}return c.on.apply(this,arguments);},_setStrokeProps:function(B){var w,A,z,y,x,v;if(B){w=B.color;A=h(B.weight);z=h(B.opacity);y=B.linejoin||"round";x=B.linecap||"butt";v=B.dashstyle;this._miterlimit=null;this._dashstyle=(v&&c.Lang.isArray(v)&&v.length>1)?v:null;this._strokeWeight=A;if(n(A)&&A>0){this._stroke=1;}else{this._stroke=0;}if(n(z)){this._strokeStyle=this._toRGBA(w,z);}else{this._strokeStyle=w;}this._linecap=x;if(y=="round"||y=="bevel"){this._linejoin=y;}else{y=parseInt(y,10);if(n(y)){this._miterlimit=Math.max(y,1);this._linejoin="miter";}}}else{this._stroke=0;}},set:function(){var v=this,w=arguments[0];l.prototype.set.apply(v,arguments);if(v.initialized){v._updateHandler();}},_setFillProps:function(z){var x=n,v,w,y;if(z){v=z.color;y=z.type;if(y=="linear"||y=="radial"){this._fillType=y;}else{if(v){w=z.opacity;if(x(w)){w=Math.max(0,Math.min(1,w));v=this._toRGBA(v,w);}else{v=s(v);}this._fillColor=v;this._fillType="solid";}else{this._fillColor=null;}}}else{this._fillType=null;this._fillColor=null;}},translate:function(v,w){this._translateX+=v;this._translateY+=w;this._addTransform("translate",arguments);},translateX:function(v){this._translateX+=v;this._addTransform("translateX",arguments);},translateY:function(v){this._translateY+=v;this._addTransform("translateY",arguments);},skew:function(v,w){this._addTransform("skew",arguments);},skewX:function(v){this._addTransform("skewX",arguments);},skewY:function(v){this._addTransform("skewY",arguments);},rotate:function(v){this._rotation=v;this._addTransform("rotate",arguments);},scale:function(v,w){this._addTransform("scale",arguments);},_rotation:0,_transform:"",_addTransform:function(w,v){v=c.Array(v);this._transform=t.trim(this._transform+" "+w+"("+v.join(", ")+")");v.unshift(w);this._transforms.push(v);if(this.initialized){this._updateTransform();}},_updateTransform:function(){var B=this.node,A,y,x=this.get("transformOrigin"),w=this.matrix,z=0,v=this._transforms.length;if(this._transforms&&this._transforms.length>0){for(;z<v;++z){A=this._transforms[z].shift();if(A){w[A].apply(w,this._transforms[z]);}}y=w.toCSSText();}this._graphic.addToRedrawQueue(this);x=(100*x[0])+"% "+(100*x[1])+"%";B.style.MozTransformOrigin=x;B.style.webkitTransformOrigin=x;B.style.msTransformOrigin=x;B.style.OTransformOrigin=x;if(y){B.style.MozTransform=y;B.style.webkitTransform=y;B.style.msTransform=y;B.style.OTransform=y;}this._transforms=[];
},_updateHandler:function(){this._draw();this._updateTransform();},_draw:function(){var v=this.node;this.clear();this._closePath();v.style.left=this.get("x")+"px";v.style.top=this.get("y")+"px";},_closePath:function(){if(!this._methods){return;}var A=this.get("node"),H=this._right-this._left,E=this._bottom-this._top,x=this._context,B=[],y=this._methods.concat(),D=0,C,v,G,z,F=0;this._context.clearRect(0,0,A.width,A.height);if(this._methods){F=y.length;if(!F||F<1){return;}for(;D<F;++D){B[D]=y[D].concat();G=B[D];z=G[0]=="quadraticCurveTo"?G.length:3;for(C=1;C<z;++C){if(C%2===0){G[C]=G[C]-this._top;}else{G[C]=G[C]-this._left;}}}A.setAttribute("width",Math.min(H,2000));A.setAttribute("height",Math.min(2000,E));x.beginPath();for(D=0;D<F;++D){G=B[D].concat();if(G&&G.length>0){v=G.shift();if(v){if(v=="closePath"){this._strokeAndFill(x);}if(v&&v=="lineTo"&&this._dashstyle){G.unshift(this._xcoords[D]-this._left,this._ycoords[D]-this._top);this._drawDashedLine.apply(this,G);}else{x[v].apply(x,G);}}}}this._strokeAndFill(x);this._drawingComplete=true;this._clearAndUpdateCoords();this._updateNodePosition();this._methods=y;}},_strokeAndFill:function(v){if(this._fillType){if(this._fillType=="linear"){v.fillStyle=this._getLinearGradient();}else{if(this._fillType=="radial"){v.fillStyle=this._getRadialGradient();}else{v.fillStyle=this._fillColor;}}v.closePath();v.fill();}if(this._stroke){if(this._strokeWeight){v.lineWidth=this._strokeWeight;}v.lineCap=this._linecap;v.lineJoin=this._linejoin;if(this._miterlimit){v.miterLimit=this._miterlimit;}v.strokeStyle=this._strokeStyle;v.stroke();}},_drawDashedLine:function(E,K,v,H){var w=this._context,I=this._dashstyle[0],G=this._dashstyle[1],y=I+G,B=v-E,F=H-K,J=Math.sqrt(Math.pow(B,2)+Math.pow(F,2)),z=Math.floor(Math.abs(J/y)),x=Math.atan2(F,B),D=E,C=K,A;B=Math.cos(x)*y;F=Math.sin(x)*y;for(A=0;A<z;++A){w.moveTo(D,C);w.lineTo(D+Math.cos(x)*I,C+Math.sin(x)*I);D+=B;C+=F;}w.moveTo(D,C);J=Math.sqrt((v-D)*(v-D)+(H-C)*(H-C));if(J>I){w.lineTo(D+Math.cos(x)*I,C+Math.sin(x)*I);}else{if(J>0){w.lineTo(D+Math.cos(x)*J,C+Math.sin(x)*J);}}w.moveTo(v,H);},clear:function(){this._initProps();if(this.node){this._context.clearRect(0,0,this.node.width,this.node.height);}return this;},getBounds:function(){var C=this.get("stroke"),A=this.get("width"),B=this.get("height"),z=this.get("x"),D=this.get("y"),v=0;if(C&&C.weight){v=C.weight;}A=(z+A+v)-(z-v);B=(D+B+v)-(D-v);z-=v;D-=v;return this.matrix.getContentRect(A,B,z,D);},destroy:function(){var v=this.get("graphic");if(v){v.removeShape(this);}else{this._destroy();}},_destroy:function(){if(this.node){c.one(this.node).remove(true);this._context=null;this.node=null;}}},c.CanvasDrawing.prototype));m.ATTRS={transformOrigin:{valueFn:function(){return[0.5,0.5];}},transform:{setter:function(v){this.matrix.init();this._transforms=this.matrix.getTransformArray(v);this._transform=v;return v;},getter:function(){return this._transform;}},node:{readOnly:true,getter:function(){return this.node;}},id:{valueFn:function(){return c.guid();},setter:function(w){var v=this.node;if(v){v.setAttribute("id",w);}return w;}},width:{value:0},height:{value:0},x:{value:0},y:{value:0},visible:{value:true,setter:function(x){var w=this.get("node"),v=x?"visible":"hidden";if(w){w.style.visibility=v;}return x;}},fill:{valueFn:"_getDefaultFill",setter:function(x){var w,v=this.get("fill")||this._getDefaultFill();w=(x)?c.merge(v,x):null;if(w&&w.color){if(w.color===undefined||w.color=="none"){w.color=null;}}this._setFillProps(w);return w;}},stroke:{valueFn:"_getDefaultStroke",setter:function(x){var w=this.get("stroke")||this._getDefaultStroke(),v;if(x&&x.hasOwnProperty("weight")){v=parseInt(x.weight,10);if(!isNaN(v)){x.weight=v;}}x=(x)?c.merge(w,x):null;this._setStrokeProps(x);return x;}},autoSize:{value:false},pointerEvents:{value:"visiblePainted"},graphic:{readOnly:true,getter:function(){return this._graphic;}}};c.CanvasShape=m;o=function(v){o.superclass.constructor.apply(this,arguments);};o.NAME="canvasPath";c.extend(o,c.CanvasShape,{_type:"path",_draw:function(){this._closePath();},createNode:function(){var v=c.config.doc.createElement("canvas"),w=this.get("id");this._context=v.getContext("2d");v.setAttribute("overflow","visible");v.setAttribute("pointer-events","none");v.style.pointerEvents="none";v.style.overflow="visible";v.setAttribute("id",w);w="#"+w;this.node=v;this.addClass(e(r)+" "+e(this.name));},end:function(){this._draw();}});o.ATTRS=c.merge(c.CanvasShape.ATTRS,{width:{getter:function(){var v=this._stroke&&this._strokeWeight?(this._strokeWeight*2):0;return this._width-v;},setter:function(v){this._width=v;return v;}},height:{getter:function(){var v=this._stroke&&this._strokeWeight?(this._strokeWeight*2):0;return this._height-v;},setter:function(v){this._height=v;return v;}},path:{readOnly:true,getter:function(){return this._path;}}});c.CanvasPath=o;u=function(){u.superclass.constructor.apply(this,arguments);};u.NAME="canvasRect";c.extend(u,c.CanvasShape,{_type:"rect",_draw:function(){var v=this.get("width"),x=this.get("height");this.clear();this.drawRect(0,0,v,x);this._closePath();}});u.ATTRS=c.CanvasShape.ATTRS;c.CanvasRect=u;p=function(v){p.superclass.constructor.apply(this,arguments);};p.NAME="canvasEllipse";c.extend(p,m,{_type:"ellipse",_draw:function(){var v=this.get("width"),x=this.get("height");this.clear();this.drawEllipse(0,0,v,x);this._closePath();}});p.ATTRS=c.merge(m.ATTRS,{xRadius:{setter:function(v){this.set("width",v*2);},getter:function(){var v=this.get("width");if(v){v*=0.5;}return v;}},yRadius:{setter:function(v){this.set("height",v*2);},getter:function(){var v=this.get("height");if(v){v*=0.5;}return v;}}});c.CanvasEllipse=p;j=function(v){j.superclass.constructor.apply(this,arguments);};j.NAME="canvasCircle";c.extend(j,c.CanvasShape,{_type:"circle",_draw:function(){var v=this.get("radius");if(v){this.clear();this.drawCircle(0,0,v);this._closePath();}}});j.ATTRS=c.merge(c.CanvasShape.ATTRS,{width:{setter:function(v){this.set("radius",v/2);return v;},getter:function(){return this.get("radius")*2;
}},height:{setter:function(v){this.set("radius",v/2);return v;},getter:function(){return this.get("radius")*2;}},radius:{lazyAdd:false}});c.CanvasCircle=j;g=function(){g.superclass.constructor.apply(this,arguments);};g.NAME="canvasPieSlice";c.extend(g,c.CanvasShape,{_type:"path",_draw:function(B){var w=this.get("cx"),C=this.get("cy"),A=this.get("startAngle"),z=this.get("arc"),v=this.get("radius");this.clear();this._left=w;this._right=v;this._top=C;this._bottom=v;this.drawWedge(w,C,A,z,v);this.end();}});g.ATTRS=c.mix({cx:{value:0},cy:{value:0},startAngle:{value:0},arc:{value:0},radius:{value:0}},c.CanvasShape.ATTRS);c.CanvasPieSlice=g;function d(v){d.superclass.constructor.apply(this,arguments);}d.NAME="canvasGraphic";d.ATTRS={render:{},id:{valueFn:function(){return c.guid();},setter:function(w){var v=this._node;if(v){v.setAttribute("id",w);}return w;}},shapes:{readOnly:true,getter:function(){return this._shapes;}},contentBounds:{readOnly:true,getter:function(){return this._contentBounds;}},node:{readOnly:true,getter:function(){return this._node;}},width:{setter:function(v){if(this._node){this._node.style.width=v+"px";}return v;}},height:{setter:function(v){if(this._node){this._node.style.height=v+"px";}return v;}},autoSize:{value:false},resizeDown:{getter:function(){return this._resizeDown;},setter:function(v){this._resizeDown=v;if(this._node){this._redraw();}return v;}},x:{getter:function(){return this._x;},setter:function(v){this._x=v;if(this._node){this._node.style.left=v+"px";}return v;}},y:{getter:function(){return this._y;},setter:function(v){this._y=v;if(this._node){this._node.style.top=v+"px";}return v;}},autoDraw:{value:true},visible:{value:true,setter:function(v){this._toggleVisible(v);return v;}}};c.extend(d,c.GraphicBase,{_x:0,_y:0,getXY:function(){var v=c.one(this._node),w;if(v){w=v.getXY();}return w;},_resizeDown:false,initializer:function(y){var A=this.get("render"),x=this.get("visible")?"visible":"hidden",v=this.get("width")||0,z=this.get("height")||0;this._shapes={};this._redrawQueue={};this._contentBounds={left:0,top:0,right:0,bottom:0};this._node=f.createElement("div");this._node.style.position="absolute";this._node.style.visibility=x;this.set("width",v);this.set("height",z);if(A){this.render(A);}},render:function(z){var v=c.one(z),A=this._node,x=this.get("width")||parseInt(v.getComputedStyle("width"),10),y=this.get("height")||parseInt(v.getComputedStyle("height"),10);v=v||f.body;v.appendChild(A);A.style.display="block";A.style.position="absolute";A.style.left="0px";A.style.top="0px";this.set("width",x);this.set("height",y);this.parentNode=v;return this;},destroy:function(){this.removeAllShapes();if(this._node){this._removeChildren(this._node);c.one(this._node).destroy();}},addShape:function(v){v.graphic=this;if(!this.get("visible")){v.visible=false;}var x=this._getShapeClass(v.type),w=new x(v);this._appendShape(w);return w;},_appendShape:function(w){var x=w.node,v=this._frag||this._node;if(this.get("autoDraw")){v.appendChild(x);}else{this._getDocFrag().appendChild(x);}},removeShape:function(v){if(!(v instanceof m)){if(t.isString(v)){v=this._shapes[v];}}if(v&&v instanceof m){v._destroy();delete this._shapes[v.get("id")];}if(this.get("autoDraw")){this._redraw();}return v;},removeAllShapes:function(){var v=this._shapes,w;for(w in v){if(v.hasOwnProperty(w)){v[w].destroy();}}this._shapes={};},clear:function(){this.removeAllShapes();},_removeChildren:function(v){if(v&&v.hasChildNodes()){var w;while(v.firstChild){w=v.firstChild;this._removeChildren(w);v.removeChild(w);}}},_toggleVisible:function(y){var x,w=this._shapes,v=y?"visible":"hidden";if(w){for(x in w){if(w.hasOwnProperty(x)){w[x].set("visible",y);}}}if(this._node){this._node.style.visibility=v;}},_getShapeClass:function(w){var v=this._shapeClass[w];if(v){return v;}return w;},_shapeClass:{circle:c.CanvasCircle,rect:c.CanvasRect,path:c.CanvasPath,ellipse:c.CanvasEllipse,pieslice:c.CanvasPieSlice},getShapeById:function(w){var v=this._shapes[w];return v;},batch:function(w){var v=this.get("autoDraw");this.set("autoDraw",false);w();this._redraw();this.set("autoDraw",v);},_getDocFrag:function(){if(!this._frag){this._frag=f.createDocumentFragment();}return this._frag;},_redraw:function(){var v=this.get("resizeDown")?this._getUpdatedContentBounds():this._contentBounds;if(this.get("autoSize")){this.set("width",v.right);this.set("height",v.bottom);}if(this._frag){this._node.appendChild(this._frag);this._frag=null;}},addToRedrawQueue:function(v){var x,w;this._shapes[v.get("id")]=v;if(!this.get("resizeDown")){x=v.getBounds();w=this._contentBounds;w.left=w.left<x.left?w.left:x.left;w.top=w.top<x.top?w.top:x.top;w.right=w.right>x.right?w.right:x.right;w.bottom=w.bottom>x.bottom?w.bottom:x.bottom;w.width=w.right-w.left;w.height=w.bottom-w.top;this._contentBounds=w;}if(this.get("autoDraw")){this._redraw();}},_getUpdatedContentBounds:function(){var z,x,w,v=this._shapes,y={left:0,top:0,right:0,bottom:0};for(x in v){if(v.hasOwnProperty(x)){w=v[x];z=w.getBounds();y.left=Math.min(y.left,z.left);y.top=Math.min(y.top,z.top);y.right=Math.max(y.right,z.right);y.bottom=Math.max(y.bottom,z.bottom);}}y.width=y.right-y.left;y.height=y.bottom-y.top;this._contentBounds=y;return y;}});c.CanvasGraphic=d;},"3.6.0pr3",{requires:["graphics"],skinnable:false});